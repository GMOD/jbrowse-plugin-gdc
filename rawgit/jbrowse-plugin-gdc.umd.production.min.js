!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@jbrowse/core/configuration"),require("@jbrowse/core/Plugin"),require("@jbrowse/core/pluggableElementTypes/DisplayType"),require("@jbrowse/core/pluggableElementTypes/models"),require("@jbrowse/core/util/types/mst"),require("react"),require("@material-ui/core/SvgIcon"),require("@jbrowse/core/util/tracks"),require("@jbrowse/core/util"),require("mobx-state-tree"),require("@jbrowse/core/data_adapters/BaseAdapter"),require("@jbrowse/core/util/rxjs")):"function"==typeof define&&define.amd?define(["exports","@jbrowse/core/configuration","@jbrowse/core/Plugin","@jbrowse/core/pluggableElementTypes/DisplayType","@jbrowse/core/pluggableElementTypes/models","@jbrowse/core/util/types/mst","react","@material-ui/core/SvgIcon","@jbrowse/core/util/tracks","@jbrowse/core/util","mobx-state-tree","@jbrowse/core/data_adapters/BaseAdapter","@jbrowse/core/util/rxjs"],t):t((e=e||self).JBrowsePluginGDC={},e.JBrowseExports["@jbrowse/core/configuration"],e.JBrowseExports["@jbrowse/core/Plugin"],e.JBrowseExports["@jbrowse/core/pluggableElementTypes/DisplayType"],e.JBrowseExports["@jbrowse/core/pluggableElementTypes/models"],e.JBrowseExports["@jbrowse/core/util/types/mst"],e.JBrowseExports.react,e.JBrowseExports["@material-ui/core/SvgIcon"],e.JBrowseExports["@jbrowse/core/util/tracks"],e.JBrowseExports["@jbrowse/core/util"],e.JBrowseExports["mobx-state-tree"],e.JBrowseExports["@jbrowse/core/data_adapters/BaseAdapter"],e.JBrowseExports["@jbrowse/core/util/rxjs"])}(this,(function(e,t,r,n,a,o,i,l,c,s,u,p,d){"use strict";function m(e,t,r,n,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){m(o,n,a,i,l,"next",e)}function l(e){m(o,n,a,i,l,"throw",e)}i(void 0)}))}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),e}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=w(e);if(t){var a=w(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return j(this,r)}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}return r}}(e,t)||A(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(e){if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=A(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l;var S=function(e){var t=e.jbrequire("mobx-state-tree").types,r=t.model({id:t.identifier,category:t.string,type:t.string,filter:t.string}).actions((function(e){return{setCategory:function(t){e.category=t,e.filter=""},setFilter:function(t){e.filter=t}}})),n=t.model({id:t.identifier,value:t.string});return t.model("GDCFilterWidget",{id:o.ElementId,type:t.literal("GDCFilterWidget"),target:t.safeReference(e.pluggableConfigSchemaType("track")),filters:t.array(r),colourBy:t.map(n)}).actions((function(e){return{setTarget:function(t){e.target=t},addFilter:function(t,n,a,o){e.filters.push(r.create({id:t,category:n,type:a,filter:o}))},deleteFilter:function(t){var r=e.filters.findIndex((function(e){return e.id===t}));e.filters.remove(e.filters[r])},getFiltersByType:function(t){return e.filters.filter((function(e){return e.type===t}))},clearFilters:function(){e.filters=e.filters.filter((function(e){return 0===e.filter.length}))},setColourBy:function(t){e.colourBy[0]=t},getColourBy:function(){return e.colourBy[0]?e.colourBy[0]:{}}}}))},G="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),N=new Uint8Array(16);function P(){if(!G)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return G(N)}for(var F=[],R=0;R<256;++R)F[R]=(R+256).toString(16).substr(1);function q(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||P)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[n+o]=a[o];return t||function(e,t){var r=0;return[F[e[r++]],F[e[r++]],F[e[r++]],F[e[r++]],"-",F[e[r++]],F[e[r++]],"-",F[e[r++]],F[e[r++]],"-",F[e[r++]],F[e[r++]],"-",F[e[r++]],F[e[r++]],F[e[r++]],F[e[r++]],F[e[r++]],F[e[r++]]].join("")}(a)}function L(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function D(e,t){return e(t={exports:{}},t.exports),t.exports}var M=D((function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}}}));L(M);var B=D((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t.apply(this,arguments)}e.exports=t})),V=D((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=n.default.memo(n.default.forwardRef((function(t,o){return n.default.createElement(a.default,(0,r.default)({ref:o},t),e)})));return o.muiName=a.default.muiName,o};var r=M(B),n=M(i),a=M(l)}));L(V);var $=L(D((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=M(i),n=(0,M(V).default)(r.default.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"}),"Help");t.default=n}))),H=L(D((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=M(i),n=(0,M(V).default)(r.default.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");t.default=n}))),W=L(D((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=M(i),n=(0,M(V).default)(r.default.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");t.default=n}))),J=function(e){var t=e.jbrequire("@material-ui/core/styles").makeStyles,r=e.jbrequire("mobx-react").observer,n=e.jbrequire("react"),a=n.useState,o=e.jbrequire("@material-ui/core"),i=o.MenuItem,l=o.FormControl,c=o.FormLabel,s=o.Select,u=o.Input,p=o.Checkbox,d=o.ListItemText,m=o.IconButton,f=o.List,g=o.ListItem,y=o.Tooltip,h=t((function(e){return{root:{padding:e.spacing(1,3,1,1),background:e.palette.background.default,overflowX:"hidden"},formControl:{margin:e.spacing(1),minWidth:150}}})),v=r((function(e){var t=h(),r=e.schema,o=e.filterModel,c=e.facets,v=k(a(o.category?c.find((function(e){return e.name===o.category})):c[0]),2),b=v[0],E=v[1],_=k(a(o.filter?o.filter.split(","):[]),2),C=_[0],w=_[1];function j(e,t){var r={op:"and",content:[]};if(e.length>0){var n,a=O(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;""!==o.filter&&r.content.push({op:"in",content:{field:"".concat(o.type,"s.").concat(o.category),value:o.filter.split(",")}})}}catch(e){a.e(e)}finally{a.f()}}else r={};t.adapter.filters.set(JSON.stringify(r))}return n.createElement(n.Fragment,null,n.createElement(f,null,n.createElement(g,null,n.createElement(l,{className:t.formControl},n.createElement(s,{labelId:"category-select-label",id:"category-select",value:b,onChange:function(e){E(e.target.value),w([]),o.setCategory(e.target.value.name)},displayEmpty:!0},n.createElement(i,{disabled:!0,value:""},n.createElement("em",null,"Category")),c.map((function(e){return n.createElement(i,{value:e,key:e.name},e.prettyName)})))),n.createElement(l,{className:t.formControl},n.createElement(s,{labelId:"demo-mutiple-checkbox-label",id:"demo-mutiple-checkbox",multiple:!0,value:C,onChange:function(e){w(e.target.value),o.setFilter(e.target.value.join(",")),j(r.filters,r.target)},input:n.createElement(u,null),displayEmpty:!0,renderValue:function(e){return 0===e.length?n.createElement("em",null,"Filters"):e.join(", ")}},n.createElement(i,{disabled:!0,value:""},n.createElement("em",null,"Filters")),b.values.map((function(e){return n.createElement(i,{key:e,value:e},n.createElement(p,{checked:C.indexOf(e)>-1}),n.createElement(d,{primary:e}))})))),n.createElement(y,{title:"Remove filter","aria-label":"remove",placement:"bottom"},n.createElement(m,{"aria-label":"remove filter",onClick:function(){r.deleteFilter(o.id),j(r.filters,r.target)}},n.createElement(W,null))))))}));return{FilterList:r((function(e){var t=e.schema,r=e.type,a=e.facets,o=a[0].name;return n.createElement(n.Fragment,null,n.createElement("div",null,n.createElement(c,null,r," filters")),t.filters.map((function(e){return e.type===r?n.createElement(v,b({schema:t},{filterModel:e},{key:e.id,facets:a})):null})),n.createElement(y,{title:"Add a new filter","aria-label":"add",placement:"right"},n.createElement(m,{"aria-label":"add",onClick:function(){t.addFilter(q(),o,r,"")}},n.createElement(H,null))))}))}},z=[{name:"consequence.transcript.annotation.polyphen_impact",prettyName:"polyphen impact",values:["benign","probably_damaging","possibly_damaging","unknown"]},{name:"consequence.transcript.annotation.sift_impact",prettyName:"sift impact",values:["deleterious","tolerated","deleterious_low_confidence","tolerated_low_confidence"]},{name:"consequence.transcript.annotation.vep_impact",prettyName:"vep impact",values:["modifier","moderate","low","high"]},{name:"consequence.transcript.consequence_type",prettyName:"consequence type",values:["missense_variant","downstream_gene_variant","non_coding_transcript_exon_variant","synonymous_variant","intron_variant","upstream_gene_variant","3_prime_UTR_variant","stop_gained","frameshift_variant","5_prime_UTR_variant","splice_region_variant","splice_acceptor_variant","splice_donor_variant","inframe_deletion","inframe_insertion","start_lost","protein_altering_variant","stop_lost","stop_retained_variant","coding_sequence_variant","incomplete_terminal_codon_variant","mature_miRNA_variant"]},{name:"mutation_subtype",prettyName:"mutation subtype",values:["single base substitution","small deletion","small insertion"]},{name:"occurrence.case.observation.variant_calling.variant_caller",prettyName:"variant caller",values:["mutect2","varscan","muse","somaticsniper"]}],U=[{name:"biotype",prettyName:"biotype",values:["protein_coding","lincRNA","miRNA","transcribed_unprocessed_pseudogene","processed_pseudogene","antisense","unprocessed_pseudogene","snoRNA","IG_V_gene","processed_transcript","transcribed_processed_pseudogene","TR_V_gene","TR_J_gene","unitary_pseudogene","misc_RNA","snRNA","IG_V_pseudogene","polymorphic_pseudogene","IG_D_gene","sense_overlapping","sense_intronic","IG_C_gene","TEC","IG_J_gene","rRNA","TR_C_gene","TR_D_gene","TR_V_pseudogene","macro_lncRNA","transcribed_unitary_pseudogene","translated_unprocessed_pseudogene","vaultRNA"]},{name:"is_cancer_gene_census",prettyName:"is cancer gene census",values:["1"]}],Q=[{name:"demographic.ethnicity",prettyName:"ethnicity",values:["not hispanic or latino","not reported","hispanic or latino","unknown"]},{name:"demographic.gender",prettyName:"gender",values:["female","male","unknown","not reported","unspecified"]},{name:"demographic.race",prettyName:"race",values:["white","not reported","unknown","black or african american","asian","other","american indian or alaska native","native hawaiian or other pacific islander","not allowed to collect"]},{name:"disease_type",prettyName:"disease type",values:["adenomas and adenocarcinomas","ductal and lobular neoplasms","epithelial neoplasms, nos","gliomas","squamous cell neoplasms","myeloid leukemias","cystic, mucinous and serous neoplasms","nevi and melanomas","lymphoid leukemias","transitional cell papillomas and carcinomas","complex mixed and stromal neoplasms","neuroepitheliomatous neoplasms","neoplasms, nos","plasma cell tumors","germ cell neoplasms","mesothelial neoplasms","myomatous neoplasms","osseous and chondromatous neoplasms","mature b-cell lymphomas","chronic myeloproliferative disorders","lymphoid neoplasm diffuse large b-cell lymphoma","myelodysplastic syndromes","lipomatous neoplasms","fibromatous neoplasms","acinar cell neoplasms","meningiomas","soft tissue tumors and sarcomas, nos","not reported","thymic epithelial neoplasms","complex epithelial neoplasms","paragangliomas and glomus tumors","leukemias, nos","blood vessel tumors","miscellaneous bone tumors","specialized gonadal neoplasms","nerve sheath tumors","synovial-like neoplasms","mature t- and nk-cell lymphomas","not applicable","miscellaneous tumors","other leukemias","neoplasms of histiocytes and accessory lymphoid cells","mucoepidermoid neoplasms","adnexal and skin appendage neoplasms","basal cell neoplasms","unknown","malignant lymphomas, nos or diffuse","fibroepithelial neoplasms","granular cell tumors and alveolar soft part sarcomas","hodgkin lymphoma","trophoblastic neoplasms","myxomatous neoplasms","precursor cell lymphoblastic lymphoma","mast cell tumors","mesonephromas","immunoproliferative diseases","giant cell tumors","odontogenic tumors","lymphatic vessel tumors","other hematologic disorders"]},{name:"primary_site",prettyName:"primary site",values:["bronchus and lung","hematopoietic and reticuloendothelial systems","breast","colon","spinal cord, cranial nerves, and other parts of central nervous system","ovary","kidney","unknown","skin","pancreas","prostate gland","uterus, nos","bladder","liver and intrahepatic bile ducts","connective, subcutaneous and other soft tissues","thyroid gland","brain","esophagus","stomach","rectum","other and ill-defined sites","adrenal gland","corpus uteri","other and ill-defined digestive organs","heart, mediastinum, and pleura","cervix uteri","other and unspecified major salivary glands","lymph nodes","testis","bones, joints and articular cartilage of other and unspecified sites","retroperitoneum and peritoneum","other and ill-defined sites in lip, oral cavity and pharynx","not reported","thymus","peripheral nerves and autonomic nervous system","bones, joints and articular cartilage of limbs","small intestine","gallbladder","meninges","anus and anal canal","eye and adnexa","other and unspecified parts of biliary tract","other and unspecified urinary organs","oropharynx","other endocrine glands and related structures","larynx","other and unspecified female genital organs","other and unspecified parts of tongue","nasopharynx","rectosigmoid junction","vagina","floor of mouth","tonsil","other and unspecified parts of mouth","nasal cavity and middle ear","penis","hypopharynx","base of tongue","ureter","gum","vulva","lip","trachea","palate","blood","other and unspecified male genital organs","renal pelvis"]},{name:"project.program.name",prettyName:"program name",values:["GENIE","FM","TCGA","TARGET","MMRF","CPTAC","BEATAML1.0","NCICCR","OHSU","CGCI","WCDT","ORGANOID","CTSP","HCMI","VAREPOP"]},{name:"project.project_id",prettyName:"project id",values:["FM-AD","GENIE-MSK","GENIE-DFCI","GENIE-MDA","GENIE-JHU","GENIE-UHN","TARGET-AML","GENIE-VICC","TARGET-ALL-P2","TARGET-NBL","TCGA-BRCA","GENIE-GRCC","MMRF-COMMPASS","GENIE-NKI","TARGET-WT","TCGA-GBM","TCGA-OV","TCGA-LUAD","BEATAML1.0-COHORT","TCGA-UCEC","TCGA-KIRC","TCGA-HNSC","TCGA-LGG","TCGA-THCA","TCGA-LUSC","TCGA-PRAD","NCICCR-DLBCL","TCGA-SKCM","TCGA-COAD","TCGA-STAD","CPTAC-3","TCGA-BLCA","TARGET-OS","TCGA-LIHC","CPTAC-2","TCGA-CESC","TCGA-KIRP","TCGA-SARC","TCGA-LAML","TARGET-ALL-P3","TCGA-ESCA","TCGA-PAAD","TCGA-PCPG","OHSU-CNL","TCGA-READ","TCGA-TGCT","TCGA-THYM","CGCI-BLGSP","TCGA-KICH","WCDT-MCRPC","TCGA-ACC","TCGA-MESO","TCGA-UVM","ORGANOID-PANCREATIC","TARGET-RT","TCGA-DLBC","TCGA-UCS","BEATAML1.0-CRENOLANIB","TCGA-CHOL","CTSP-DLBCL1","TARGET-ALL-P1","HCMI-CMDC","TARGET-CCSK","VAREPOP-APOLLO"]},{name:"samples.sample_type",prettyName:"sample type",values:["primary tumor","metastatic","blood derived normal","primary blood derived cancer - bone marrow","solid tissue normal","tumor","not reported","bone marrow normal","primary blood derived cancer - peripheral blood","recurrent blood derived cancer - bone marrow","recurrent blood derived cancer - peripheral blood","blood derived cancer - peripheral blood","recurrent tumor","next generation cancer model","blood derived cancer - bone marrow, post-treatment","granulocytes","fibroblasts from bone marrow normal","primary xenograft tissue","buccal cell normal","blood derived cancer - bone marrow","unknown","additional - new primary","mononuclear cells from bone marrow normal","blood derived cancer - peripheral blood, post-treatment","cell lines","ffpe scrolls","expanded next generation cancer model","additional metastatic","lymphoid normal","post neo-adjuvant therapy","control analyte","slides"]},{name:"summary.experimental_strategies.experimental_strategy",prettyName:"experimental strategy",values:["Targeted Sequencing","WXS","RNA-Seq","miRNA-Seq","Genotyping Array","Methylation Array","Tissue Slide","Diagnostic Slide","WGS","ATAC-Seq"]}],K=[{name:"VEP",attributeName:"vep_impact",type:"category",description:"Colour by VEP impact (canonical transcript).",values:[{name:"LOW",colour:"blue"},{name:"MODIFIER",colour:"goldenrod"},{name:"MODERATE",colour:"orange"},{name:"HIGH",colour:"red"},{name:"",colour:"lightgrey"}]},{name:"PolyPhen",type:"category",attributeName:"polyphen_impact",description:"Colour by PolyPhen impact (canonical transcript).",values:[{name:"benign",colour:"green"},{name:"possibly_damaging",colour:"orange"},{name:"probably_damaging",colour:"red"},{name:"unknown",colour:"grey"},{name:"",colour:"lightgrey"}]},{name:"SIFT",type:"category",attributeName:"sift_impact",description:"Colour by SIFT impact (canonical transcript).",values:[{name:"deleterious",colour:"red"},{name:"tolerated",colour:"green"},{name:"deleterious_low_confidence",colour:"lightcoral"},{name:"tolerated_low_confidence",colour:"lightgreen"},{name:"",colour:"lightgrey"}]},{name:"Mutation Subtype",type:"category",attributeName:"mutationSubtype",description:"Colour by the type of mutation.",values:[{name:"Single base substitution",colour:"green"},{name:"Small deletion",colour:"red"},{name:"Small insertion",colour:"blue"},{name:"",colour:"lightgrey"}]},{name:"Mutation Count",type:"threshold",description:"Colour by mutation occurrence count across the current cohort.",attributeName:"score",values:[{name:"Count",colour1:"red",colour2:"blue",threshold:2}]},{name:"Mutation Frequency",type:"percentage",description:"Frequency of mutation occurrence across the current cohort.",attributeName:"percentage",values:[{name:"Percentage",colour1:"dark green",colour2:"light green"}]}],X=[{name:"Is Cancer Gene Census",attributeName:"isCancerGeneCensus",type:"boolean",description:"Colour by cancer gene census status.",values:[{name:"Is Cancer Gene Census",colour1:"red",colour2:"blue"}]}],Y=function(e){var t=e.jbrequire("react"),r=t.useState,n=e.jbrequire("mobx-react").observer,a=e.jbrequire("@material-ui/core/styles").makeStyles,o=e.jbrequire("@material-ui/core"),i=o.Typography,l=o.MenuItem,c=o.FormControl,s=o.Select,u=o.Tooltip,p=o.Table,d=o.TableBody,m=o.TableCell,f=o.TableHead,g=o.TableRow,y=a((function(e){return{root:{padding:e.spacing(1,3,1,1),background:e.palette.background.default,overflowX:"hidden"},formControl:{margin:e.spacing(1),minWidth:150},text:{display:"flex",alignItems:"center"}}}));return{HighlightFeature:n((function(e){var n=e.schema,a=e.type,o=y(),h=k(r(n.getColourBy()),2),v=h[0],b=h[1],E="mutation"===a?K:X;return t.createElement(t.Fragment,null,t.createElement(i,{variant:"h6",className:o.text},"Colour Features",t.createElement(u,{title:"Colour features on track based on feature attributes","aria-label":"help",placement:"right"},t.createElement($,null))),t.createElement(c,{className:o.formControl},t.createElement(s,{labelId:"category-select-label",id:"category-select",value:v,onChange:function(e){var t=e.target.value;b(t);var r="";if("threshold"===t.type)r="function(feature) { if (feature.get('".concat(t.attributeName,"') >= ").concat(t.values[0].threshold,") {return '").concat(t.values[0].colour1,"'; } else {return '").concat(t.values[0].colour2,"'; } }");else if("category"===t.type)if("VEP"===t.name||"SIFT"===t.name||"PolyPhen"===t.name){var a="switch(impact) {";t.values.forEach((function(e){a+="case '".concat(e.name,"': return '").concat(e.colour,"'; break;")})),a+="}",r="function(feature) { const filteredConsequences = feature.get('consequence').hits.edges.filter(cons => cons.node.transcript.is_canonical); const impact = filteredConsequences[0].node.transcript.annotation.".concat(t.attributeName,"; ").concat(a,"}")}else{var o="switch(attrValue) {";t.values.forEach((function(e){o+="case '".concat(e.name,"': return '").concat(e.colour,"'; break;")})),o+="}",r="function(feature) { const attrValue = feature.get('".concat(t.attributeName,"'); ").concat(o,"}")}else r="boolean"===t.type?"function(feature) { if (feature.get('".concat(t.attributeName,"')) {return '").concat(t.values[0].colour1,"'; } else {return '").concat(t.values[0].colour2,"'; } }"):"percentage"===t.type?"function(feature) { const logValue = feature.get('".concat(t.attributeName,"'); return 'rgb(0,' + logValue + ',0)' }"):"function(feature) { return 'goldenrod' }";n.target.displays[0].renderer.color1.set(r),n.setColourBy(JSON.stringify(t)),n.target.adapter.colourBy.set(JSON.stringify(t))}},t.createElement(l,{disabled:!0,value:""},t.createElement("em",null,"Attribute")),E.map((function(e){return t.createElement(l,{value:e,key:e.name},e.name)})))),v&&v.values&&t.createElement("div",null,t.createElement(i,{variant:"subtitle2",className:o.text},v.description),v.values&&"category"===v.type&&t.createElement(p,null,t.createElement(f,null,t.createElement(g,null,t.createElement(m,null,"Value"),t.createElement(m,null,"Colour"))),t.createElement(d,null,v.values&&v.values.map((function(e){return t.createElement(g,{key:e.name},t.createElement(m,null,""!==e.name?e.name:"n/a"),t.createElement(m,null,e.colour))})))),v.values&&"threshold"===v.type&&t.createElement(p,null,t.createElement(f,null,t.createElement(g,null,t.createElement(m,null,"Value"),t.createElement(m,null,"Threshold"),t.createElement(m,null,"Below"),t.createElement(m,null,"Equal or Above"))),t.createElement(d,null,v.values&&v.values.map((function(e){return t.createElement(g,{key:e.name},t.createElement(m,null,""!==e.name?e.name:"n/a"),t.createElement(m,null,e.threshold),t.createElement(m,null,e.colour2),t.createElement(m,null,e.colour1))})))),v.values&&"boolean"===v.type&&t.createElement(p,null,t.createElement(f,null,t.createElement(g,null,t.createElement(m,null,"Value"),t.createElement(m,null,"True"),t.createElement(m,null,"False"))),t.createElement(d,null,v.values&&v.values.map((function(e){return t.createElement(g,{key:e.name},t.createElement(m,null,""!==e.name?e.name:"n/a"),t.createElement(m,null,e.colour1),t.createElement(m,null,e.colour2))})))),v.values&&"percentage"===v.type&&t.createElement(p,null,t.createElement(f,null,t.createElement(g,null,t.createElement(m,null,"Value"),t.createElement(m,null,"Low"),t.createElement(m,null,"High"))),t.createElement(d,null,v.values&&v.values.map((function(e){return t.createElement(g,{key:e.name},t.createElement(m,null,""!==e.name?e.name:"n/a"),t.createElement(m,null,e.colour1),t.createElement(m,null,e.colour2))}))))))}))}},Z=function(e){var t=e.lib["mobx-react"].observer,r=e.lib.react,n=e.lib["@material-ui/core"],a=n.Typography,o=n.MenuItem,i=n.FormControl,l=n.Select,c=n.List,s=n.ListItem,u=e.lib["@material-ui/core/Tooltip"],p=(0,e.lib["@material-ui/core/styles"].makeStyles)((function(e){return{root:{padding:e.spacing(1,3,1,1),background:e.palette.background.default,overflowX:"hidden"},formControl:{margin:e.spacing(1),minWidth:150},text:{display:"flex",alignItems:"center"}}}));return t((function(e){var t=p(),n=k(r.useState(e.schema.target.adapter.featureType.value),2),d=n[0],m=n[1];return r.createElement(r.Fragment,null,r.createElement(a,{variant:"h6",className:t.text},"Track Type",r.createElement(u,{title:"Set the type of features to grab from the GDC portal","aria-label":"help",placement:"right"},r.createElement($,null))),r.createElement(c,null,r.createElement(s,null,r.createElement(i,{className:t.formControl},r.createElement(l,{labelId:"track-type-select-label",id:"track-type-select",value:d,onChange:function(t){m(t.target.value),e.schema.target.adapter.featureType.set(t.target.value),e.schema.target.displays[0].renderer.color1.set("function(feature) { return 'goldenrod' }"),e.schema.setColourBy("{}"),e.schema.target.adapter.colourBy.set("{}")},displayEmpty:!0},r.createElement(o,{disabled:!0,value:""},r.createElement("em",null,"Track type")),r.createElement(o,{value:"mutation"},"Mutation"),r.createElement(o,{value:"gene"},"Gene"))))))}))},ee=function(e){var t=e.jbrequire("@material-ui/core"),r=t.makeStyles,n=t.Typography,a=t.Tooltip,o=e.jbrequire("mobx-react"),i=o.observer,l=o.PropTypes,c=e.lib.react,s=c.useState,u=c.useEffect,p=e.jbrequire("@material-ui/lab").Alert,d=e.jbrequire(J).FilterList,m=e.jbrequire(Y).HighlightFeature,f=e.jbrequire(Z),g=r((function(e){return{root:{padding:e.spacing(1,3,1,1),background:e.palette.background.default,overflowX:"hidden"},formControl:{margin:e.spacing(1),minWidth:150},filterCard:{margin:e.spacing(1)},text:{display:"flex",alignItems:"center"}}})),y=i((function(e){var t=e.schema,r=k(s(!0),2),o=r[0],i=r[1],l=k(s(!0),2),y=l[0],h=l[1],v=k(s(""),2),b=v[0],E=v[1],_=k(s(""),2),C=_[0],w=_[1];t.clearFilters(),u((function(){try{var e=JSON.parse(t.target.adapter.filters.value);if(e.content&&e.content.length>0){var r,n=O(e.content);try{for(n.s();!(r=n.n()).done;){var a=r.value,o=void 0;if(a.content.field.startsWith("cases.")?o="case":a.content.field.startsWith("ssms.")?o="ssm":a.content.field.startsWith("genes.")?o="gene":(i(!1),E("The filter ".concat(a.content.field," is missing a type prefix and is invalid. Any changes on this panel will overwrite invalid filters."))),o){var l=a.content.field.replace("".concat(o,"s."),"");t.addFilter(q(),l,o,a.content.value.join(","))}}}catch(e){n.e(e)}finally{n.f()}}}catch(e){i(!1),E("The current filters are not in the expected format. Any changes on this panel will overwrite invalid filters.")}}),[t]),u((function(){try{var e=JSON.parse(t.target.adapter.colourBy.value),r=!0;["name","type","attributeName","values","description"].forEach((function(t){t in e||(r=!1)})),r||0===Object.keys(e).length?t.setColourBy(e):(h(!1),w("The current colour by option is not in the expected format. Any changes on this panel will overwrite the invalid selection."))}catch(e){h(!1),w("The current colour by option is not in the expected format. Any changes on this panel will overwrite the invalid selection.")}}),[t]);var j=g();return c.createElement(c.Fragment,null,!o&&c.createElement(p,{severity:"info"},b),c.createElement(f,{schema:t}),c.createElement(n,{variant:"h6",className:j.text},"Filters",c.createElement(a,{title:"Apply filters to the current track","aria-label":"help",placement:"right"},c.createElement($,null))),c.createElement(d,{schema:t,type:"case",facets:Q}),c.createElement(d,{schema:t,type:"gene",facets:U}),c.createElement(d,{schema:t,type:"ssm",facets:z}),!y&&c.createElement(p,{severity:"info"},C),"mutation"===t.target.adapter.featureType.value&&c.createElement(m,{schema:t,type:"mutation"}),"gene"===t.target.adapter.featureType.value&&c.createElement(m,{schema:t,type:"gene"}))}));function h(e){var t=e.model,r=g();return c.createElement("div",{className:r.root,"data-testid":"configEditor"},t.target?c.createElement(y,{schema:t,key:"configEditor"}):"no target set")}return h.propTypes={model:l.objectOrObservableObject.isRequired},i(h)},te=function(e){var t=e.lib.react,r=e.load(ee),n=e.lib["mobx-react"].observer;return{configSchema:(0,e.lib["@jbrowse/core/configuration"].ConfigurationSchema)("GDCFilterWidget",{}),ReactComponent:r,stateModel:e.load(S),HeadingComponent:n((function(){return t.createElement(t.Fragment,null,"GDC Filters")}))}},re=L(D((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=M(i),n=(0,M(V).default)(r.default.createElement("path",{d:"M19 13H5v-2h14v2z"}),"Remove");t.default=n}))),ne=D((function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var a=Object.create((t&&t.prototype instanceof p?t:p).prototype),o=new w(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return{value:void 0,done:!0}}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var l=E(i,r);if(l){if(l===u)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,o),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function p(){}function d(){}function m(){}var f={};f[a]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(j([])));y&&y!==t&&r.call(y,a)&&(f=y);var h=m.prototype=p.prototype=Object.create(f);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var n;this._invoke=function(a,o){function i(){return new t((function(n,i){!function n(a,o,i,l){var c=s(e[a],e,o);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==typeof p&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,i,l)}),(function(e){n("throw",e,i,l)})):t.resolve(p).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,l)}))}l(c.arg)}(a,o,n,i)}))}return n=n?n.then(i,i):i()}}function E(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=s(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function j(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return d.prototype=h.constructor=m,m.constructor=d,d.displayName=l(m,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e},e.awrap=function(e){return{__await:e}},v(b.prototype),b.prototype[o]=function(){return this},e.AsyncIterator=b,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new b(c(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(h),l(h,i,"Generator"),h[a]=function(){return this},h.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=j,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;C(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:j(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function ae(){return(ae=f(ne.mark((function e(t){var r,n;return ne.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={query:"query ProjectTable( $caseAggsFilters: FiltersArgument $ssmTested: FiltersArgument $cnvGain: FiltersArgument $cnvLoss: FiltersArgument $cnvTested: FiltersArgument $projectCount: Int ) { viewer { explore { cases { gain: aggregations(filters: $cnvGain) { project__project_id { buckets { docCount: doc_count projectId: key } } } loss: aggregations(filters: $cnvLoss) { project__project_id { buckets { docCount: doc_count projectId: key } } } cnvTotal: aggregations(filters: $cnvTested) { project__project_id { buckets { docCount: doc_count projectId: key } } } filtered: aggregations(filters: $caseAggsFilters) { project__project_id { buckets { docCount: doc_count projectId: key } } } total: aggregations(filters: $ssmTested) { project__project_id { buckets { docCount: doc_count projectId: key } } } } } } projects { hits(first: $projectCount) { edges { node { primary_site disease_type project_id id } } } } }",variables:{caseAggsFilters:{op:"and",content:[{op:"in",content:{field:"cases.available_variation_data",value:["ssm"]}},{op:"NOT",content:{field:"cases.gene.ssm.observation.observation_id",value:"MISSING"}},{op:"in",content:{field:"genes.gene_id",value:[t]}}]},ssmTested:{op:"and",content:[{op:"in",content:{field:"cases.available_variation_data",value:["ssm"]}}]},cnvGain:{op:"and",content:[{op:"in",content:{field:"cases.available_variation_data",value:["cnv"]}},{op:"in",content:{field:"cnvs.cnv_change",value:["Gain"]}},{op:"in",content:{field:"genes.gene_id",value:[t]}}]},cnvLoss:{op:"and",content:[{op:"in",content:{field:"cases.available_variation_data",value:["cnv"]}},{op:"in",content:{field:"cnvs.cnv_change",value:["Loss"]}},{op:"in",content:{field:"genes.gene_id",value:[t]}}]},cnvTested:{op:"and",content:[{op:"in",content:{field:"cases.available_variation_data",value:["cnv"]}}]},projectCount:100}},e.next=3,fetch("https://api.gdc.cancer.gov/v0/graphql/geneProjects",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(){return(oe=f(ne.mark((function e(t){var r,n;return ne.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={query:"query projectsTable($ssmTested: FiltersArgument, $caseAggsFilter: FiltersArgument, $projectCount: Int) { viewer { explore { cases { filtered: aggregations(filters: $caseAggsFilter) { project__project_id { buckets { docCount: doc_count projectId: key } } } total: aggregations(filters: $ssmTested) { project__project_id { buckets { docCount: doc_count projectId: key } } } } } } projects { hits(first: $projectCount) { edges { node { primary_site disease_type project_id id } } } } }",variables:{ssmTested:{op:"and",content:[{op:"in",content:{field:"cases.available_variation_data",value:["ssm"]}}]},caseAggsFilter:{op:"and",content:[{op:"in",content:{field:"ssms.ssm_id",value:[t]}},{op:"in",content:{field:"cases.available_variation_data",value:["ssm"]}}]},projectCount:100}},e.next=3,fetch("https://api.gdc.cancer.gov/v0/graphql/mutationProjects",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=function(e){var t=e.jbrequire("@material-ui/core"),r=t.Divider,n=t.Paper,a=t.Table,o=t.TableBody,i=t.TableCell,l=t.TableHead,c=t.TableRow,s=t.Chip,u=t.Tooltip,p=t.Link,d=e.jbrequire("@material-ui/core/styles").makeStyles,m=e.jbrequire("mobx-react"),f=m.observer,g=m.PropTypes,y=e.jbrequire("prop-types"),h=e.jbrequire("react"),v=h.useState,E=h.useEffect,_=e.jbrequire("@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail"),C=_.BaseFeatureDetails,w=_.BaseCard,j=d((function(){return{table:{padding:0},link:{color:"rgb(0, 0, 238)"}}}));function T(e){var t=j(),r=e.feature;if(!r.consequence)return null;var n=r.consequence.hits.edges;return h.createElement(w,{title:"Consequence"},h.createElement("div",{style:{width:"100%",maxHeight:600,overflow:"auto"}},h.createElement(a,{className:t.table},h.createElement(l,null,h.createElement(c,null,h.createElement(i,null,"Gene"),h.createElement(i,null,"AA Change"),h.createElement(i,null,"Consequence"),h.createElement(i,null,"Coding DNA Change"),h.createElement(i,null,"Impact"),h.createElement(i,null,"Gene Strand"),h.createElement(i,null,"Transcript"))),h.createElement(o,null,Object.entries(n).map((function(e){var r=k(e,2),n=r[1];return n&&h.createElement(c,{key:r[0]},h.createElement(i,null,h.createElement(p,{className:t.link,target:"_blank",rel:"noopener",href:"https://portal.gdc.cancer.gov/genes/".concat(n.node.transcript.gene.gene_id),underline:"always"},n.node.transcript.gene.symbol)),h.createElement(i,null,n.node.transcript.aa_change),h.createElement(i,null,n.node.transcript.consequence_type),h.createElement(i,null,n.node.transcript.annotation.hgvsc),h.createElement(i,null,n.node.transcript.annotation.vep_impact&&h.createElement(u,{title:"VEP ".concat(n.node.transcript.annotation.vep_impact),"aria-label":"help",placement:"left"},h.createElement(s,{label:n.node.transcript.annotation.vep_impact})),n.node.transcript.annotation.sift_impact&&h.createElement(u,{title:"SIFT ".concat(n.node.transcript.annotation.sift_impact," (").concat(n.node.transcript.annotation.sift_score,")"),"aria-label":"help",placement:"left"},h.createElement(s,{label:n.node.transcript.annotation.sift_impact})),n.node.transcript.annotation.polyphen_impact&&h.createElement(u,{title:"PolyPhen ".concat(n.node.transcript.annotation.polyphen_impact," (").concat(n.node.transcript.annotation.polyphen_score,")"),"aria-label":"help",placement:"left"},h.createElement(s,{label:n.node.transcript.annotation.polyphen_impact}))),h.createElement(i,null,h.createElement(1===n.node.transcript.gene.gene_strand?H:re,null)),h.createElement(i,null,h.createElement(p,{className:t.link,target:"_blank",rel:"noopener",href:"http://may2015.archive.ensembl.org/Homo_sapiens/Gene/Summary?db=core;g=".concat(n.node.transcript.transcript_id),underline:"always"},n.node.transcript.transcript_id),n.node.transcript.is_canonical&&h.createElement(u,{title:"Canonical transcript","aria-label":"help",placement:"right"},h.createElement(s,{label:"C"}))))}))))))}T.propTypes={feature:y.shape().isRequired};var I=f((function(e){var t=j(),r=e.id,n=e.name,a=e.link;return h.createElement(h.Fragment,null,h.createElement(c,{key:"".concat(r,"-").concat(n)},h.createElement(i,null,n),h.createElement(i,null,h.createElement(p,{className:t.link,target:"_blank",rel:"noopener",href:"".concat(a).concat(r),underline:"always"},r))))}));function A(e){var t=j(),r=e.feature;return h.createElement(w,{title:"External Links"},h.createElement("div",{style:{width:"100%",maxHeight:600,overflow:"auto"}},h.createElement(a,{className:t.table},h.createElement(o,null,[{id:r.geneId,name:"GDC",link:"https://portal.gdc.cancer.gov/genes/"},{id:r.geneId,name:"ENSEMBL",link:"http://www.ensembl.org/id/"},{id:r.canonicalTranscriptId,name:"Canonical Transcript ID",link:"http://www.ensembl.org/id/"},{id:r.externalDbIds.hgnc[0],name:"HGNC",link:"https://www.genenames.org/data/gene-symbol-report/#!/hgnc_id/"},{id:r.externalDbIds.uniprotkbSwissprot[0],name:"UniProtKB Swiss-Prot",link:"http://www.uniprot.org/uniprot/"},{id:r.externalDbIds.entrezGene[0],name:"NCBI",link:"http://www.ncbi.nlm.nih.gov/gene/"},{id:r.externalDbIds.omimGene[0],name:"OMIM",link:"https://www.omim.org/entry/"}].map((function(e,t){return h.createElement(I,b({},e,{key:t}))}))))))}function x(e){return e.replace("COSM","").replace("COSN","")}A.propTypes={feature:y.shape().isRequired};var O=f((function(e){var t=j(),r=e.cosmicId;return h.createElement(h.Fragment,null,h.createElement(c,{key:"0"},h.createElement(i,null,"Cosmic"),h.createElement(i,null,r&&r.map((function(e){return h.createElement(p,{className:t.link,target:"_blank",rel:"noopener",href:"https://cancer.sanger.ac.uk/cosmic/mutation/overview?id=".concat(x(e)),key:e,underline:"always"},e)})))))}));function S(e){var t=j(),r=e.feature;return h.createElement(w,{title:"External Links"},h.createElement("div",{style:{width:"100%",maxHeight:600,overflow:"auto"}},h.createElement(a,{className:t.table},h.createElement(o,null,[{id:r.ssmId,name:"GDC",link:"https://portal.gdc.cancer.gov/ssms/"}].map((function(e,t){return h.createElement(I,b({},e,{key:t}))})),r.cosmicId&&h.createElement(O,{cosmicId:r.cosmicId})))))}function G(e){var t=j(),r=e.projectId,n=e.docCount,a=e.gdcProjectsCounts,o=e.projectsInformation.find((function(e){return e.node.project_id===r})),l=a.find((function(e){return e.projectId===r}));return h.createElement(h.Fragment,null,h.createElement(c,{key:r},h.createElement(i,null,h.createElement(p,{className:t.link,target:"_blank",rel:"noopener",href:"https://portal.gdc.cancer.gov/projects/".concat(r),underline:"always"},r)),h.createElement(i,null,o.node.disease_type.join(", ")),h.createElement(i,null,o.node.primary_site.join(", ")),h.createElement(i,null,n," / ",l.docCount)))}function N(e){var t=j(),r=e.featureId,n=k(v([]),2),s=n[0],u=n[1],p=k(v([]),2),d=p[0],m=p[1],f=k(v([]),2),g=f[0],y=f[1];return E((function(){(function(e){return oe.apply(this,arguments)})(r).then((function(e){m(e.data.projects.hits.edges),y(e.data.viewer.explore.cases.total.project__project_id.buckets),u(e.data.viewer.explore.cases.filtered.project__project_id.buckets)}))}),[r]),h.createElement(w,{title:"Projects"},h.createElement("div",{style:{width:"100%",maxHeight:600,overflow:"auto"}},h.createElement(a,{className:t.table},h.createElement(l,null,h.createElement(c,null,h.createElement(i,null,"Project"),h.createElement(i,null,"Disease Type"),h.createElement(i,null,"Site"),h.createElement(i,null,"# Mutation Affected Cases"))),h.createElement(o,null,s&&d&&g&&s.map((function(e,t){return h.createElement(G,b({projectsInformation:d,gdcProjectsCounts:g,key:"".concat(t,"-").concat(e.projectId)},e))}))))))}function P(e){var t=j(),r=e.projectId,n=e.docCount,a=e.cases,o=e.projectsInformation.find((function(e){return e.node.project_id===r})),l=a.total.project__project_id.buckets.find((function(e){return e.projectId===r})),s=a.gain.project__project_id.buckets.find((function(e){return e.projectId===r})),u=a.loss.project__project_id.buckets.find((function(e){return e.projectId===r})),d=a.cnvTotal.project__project_id.buckets.find((function(e){return e.projectId===r}));return h.createElement(h.Fragment,null,h.createElement(c,{key:r},h.createElement(i,null,h.createElement(p,{className:t.link,target:"_blank",rel:"noopener",href:"https://portal.gdc.cancer.gov/projects/".concat(r),underline:"always"},r)),h.createElement(i,null,o.node.disease_type.join(", ")),h.createElement(i,null,o.node.primary_site.join(", ")),h.createElement(i,null,n," / ",l.docCount),h.createElement(i,null,s?s.docCount:"0"," /"," ",d.docCount),h.createElement(i,null,u?u.docCount:"0"," /"," ",d.docCount)))}function F(e){var t=j(),r=e.featureId,n=k(v([]),2),s=n[0],u=n[1],p=k(v([]),2),d=p[0],m=p[1],f=k(v([]),2),g=f[0],y=f[1];return E((function(){(function(e){return ae.apply(this,arguments)})(r).then((function(e){u(e.data.projects.hits.edges),y(e.data.viewer.explore.cases),m(e.data.viewer.explore.cases.filtered.project__project_id.buckets)}))}),[r]),h.createElement(w,b({},e,{title:"Projects"}),h.createElement("div",{style:{width:"100%",maxHeight:600,overflow:"auto"}},h.createElement(a,{className:t.table},h.createElement(l,null,h.createElement(c,null,h.createElement(i,null,"Project"),h.createElement(i,null,"Disease Type"),h.createElement(i,null,"Site"),h.createElement(i,null,"# Mutation Affected Cases"),h.createElement(i,null,"# CNV Gains"),h.createElement(i,null,"# CNV Losses"))),h.createElement(o,null,g&&s&&d&&d.map((function(e,t){return h.createElement(P,b({cases:g,projectsInformation:s,key:"".concat(t,"-").concat(e.projectId)},e))}))))))}function R(e){var t=j(),a=JSON.parse(JSON.stringify(e.model.featureData)),o=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(a,["consequence","geneId","ssmId","cosmicId","canonicalTranscriptId","externalDbIds","percentage","numOfCasesInCohort"]);return h.createElement(n,{className:t.root,"data-testid":"variant-widget"},h.createElement(C,b({feature:o},e)),h.createElement(r,null),a.geneId&&h.createElement(A,{feature:a}),a.ssmId&&h.createElement(S,{feature:a}),h.createElement(r,null),a.ssmId&&h.createElement(T,{feature:a}),h.createElement(r,null),a.geneId&&h.createElement(F,{featureId:a.geneId}),a.ssmId&&h.createElement(N,{featureId:a.ssmId}))}return O.propTypes={cosmicId:y.array.isRequired},S.propTypes={feature:y.shape().isRequired},G.propTypes={projectId:y.string.isRequired,docCount:y.number.isRequired,projectsInformation:y.array.isRequired,gdcProjectsCounts:y.array.isRequired},N.propTypes={featureId:y.string.isRequired},P.propTypes={projectId:y.string.isRequired,docCount:y.number.isRequired,projectsInformation:y.array.isRequired,cases:y.object.isRequired},F.propTypes={featureId:y.string.isRequired},R.propTypes={model:g.observableObject.isRequired},f(R)},le=function(e){var r=e.jbrequire("mobx-state-tree").types;return{configSchema:t.ConfigurationSchema("GDCFeatureWidget",{}),stateModel:r.model("GDCFeatureWidget",{id:o.ElementId,type:r.literal("GDCFeatureWidget"),featureData:r.frozen({})}).actions((function(e){return{setFeatureData:function(t){e.featureData=t},clearFeatureData:function(){e.featureData={}}}})),ReactComponent:e.jbrequire(ie)}},ce=function(e){var r=e.getPlugin("LinearGenomeViewPlugin").exports.baseLinearDisplayConfigSchema;return t.ConfigurationSchema("LinearGDCDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:r,explicitlyTyped:!0})},se=L(D((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=M(i),n=(0,M(V).default)(r.default.createElement("path",{d:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"}),"FilterList");t.default=n}))),ue=function(e){var r=e.jbrequire("mobx-state-tree").types,n=e.jbrequire(ce),a=e.getPlugin("LinearGenomeViewPlugin").exports.BaseLinearDisplay;return r.compose("LinearGDCDisplay",a,r.model({type:r.literal("LinearGDCDisplay"),configuration:t.ConfigurationReference(n)})).actions((function(e){return{openFilterConfig:function(){var t=s.getSession(e),r=t.addWidget("GDCFilterWidget","gdcFilter",{target:e.parentTrack.configuration});t.showWidget(r)},selectFeature:function(t){var r=s.getSession(e),n=r.addWidget("GDCFeatureWidget","gdcFeature",{featureData:t.toJSON()});r.showWidget(n),r.setSelection(t)}}})).views((function(e){return{get renderProps(){return _(_(_({},e.composedRenderProps),c.getParentRenderProps(e)),{},{config:e.configuration.renderer})},get rendererTypeName(){return e.configuration.renderer.type},get trackMenuItems(){return[{label:"Filter",onClick:e.openFilterConfig,icon:se}]}}}))},pe=function(e){return{configSchema:e.jbrequire(ce),stateModel:e.jbrequire(ue)}},de=t.ConfigurationSchema("GDCAdapter",{filters:{type:"string",defaultValue:"{}",description:"The filters to be applied to the track. Only edit if you know what you are doing."},colourBy:{type:"string",defaultValue:"{}",description:"Colour features based on track attributes. Only edit if you know what you are doing."},featureType:{type:"stringEnum",model:u.types.enumeration("Feature Type",["mutation","gene"]),defaultValue:"mutation",description:"The type of track to add"},cases:{type:"stringArray",defaultValue:[],description:"GDC case UUIDs"},size:{type:"integer",defaultValue:5e3,description:"The max number of features to show."}},{explicitlyTyped:!0}),me=function(){function e(t){g(this,e),this.gdcObject=t.gdcObject,this.featureType=t.featureType?t.featureType:"mutation",this.data=this.dataFromGDCObject(this.gdcObject,this.featureType),this.uniqueId=t.id}return h(e,[{key:"get",value:function(e){return this.gdcObject[e]||this.data[e]}},{key:"set",value:function(){}},{key:"parent",value:function(){}},{key:"children",value:function(){}},{key:"tags",value:function(){return[].concat(I(Object.keys(this.data)),I(Object.keys(this.gdcObject)))}},{key:"id",value:function(){return this.uniqueId}},{key:"dataFromGDCObject",value:function(e,t){var r={refName:e.chromosome,type:e.mutationType,start:e.startPosition-1,end:e.endPosition};switch(t){case"gene":r.start=e.geneStart-1,r.end=e.geneEnd,r.refName=e.geneChromosome,r.type=e.biotype}return r}},{key:"toJSON",value:function(){return _(_({uniqueId:this.uniqueId},this.data),this.gdcObject)}}]),e}(),fe=function(e){C(a,e);var r,n=T(a);function a(e){var r;g(this,a),r=n.call(this,e);var o=t.readConfObject(e,"filters"),i=t.readConfObject(e,"cases"),l=t.readConfObject(e,"size"),c=t.readConfObject(e,"featureType");return r.filters=o,r.cases=i,r.size=l,r.featureType=c,r}return h(a,[{key:"getRefNames",value:(r=f(ne.mark((function e(){return ne.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["chr1","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr2","chr20","chr21","chr22","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chrX","chrY"]);case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"getFeatures",value:function(e,t){var r=this,n=e.refName,a=e.start,o=e.end;return d.ObservableCreate(function(){var e=f(ne.mark((function e(i){var l,c,s,u,p,d,m,f,g,y,h,v,b,E,_;return ne.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,l={},c="ssmId",e.t0=r.featureType,e.next="mutation"===e.t0?6:"gene"===e.t0?9:12;break;case 6:return l=r.createMutationQuery(n.replace(/chr/,""),a,o),c="ssmId",e.abrupt("break",13);case 9:return l=r.createGeneQuery(n.replace(/chr/,""),a,o),c="geneId",e.abrupt("break",13);case 12:i.error("Not a valid type: ".concat(r.featureType));case 13:return e.next=15,fetch("https://api.gdc.cancer.gov/v0/graphql",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(l),signal:t.signal});case 15:return s=e.sent,e.next=18,s.json();case 18:if(p=(u=e.sent).data.viewer.explore.features.hits.edges,"mutation"===r.featureType){d=u.data.viewer.explore.filteredCases.hits.total,m=Math.ceil(Math.log10(d)),f=O(p);try{for(f.s();!(g=f.n()).done;)(y=g.value.node).numOfCasesInCohort=d,y.percentage=100*Math.log10(y.score)/m+100,y.occurrenceInCohort="".concat(y.score," / ").concat(d),h=new me({gdcObject:y,id:y[c],featureType:r.featureType}),i.next(h)}catch(e){f.e(e)}finally{f.f()}}else{v=O(p);try{for(v.s();!(b=v.n()).done;)_=new me({gdcObject:E=b.value.node,id:E[c],featureType:r.featureType}),i.next(_)}catch(e){v.e(e)}finally{v.f()}}e.next=26;break;case 23:e.prev=23,e.t1=e.catch(0),i.error(e.t1);case 26:i.complete();case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t){return e.apply(this,arguments)}}(),t.signal)}},{key:"freeResources",value:function(){}},{key:"createMutationQuery",value:function(e,t,r){var n=this.getFilterQuery(e,t,r,!1),a=this.getFilterQuery(e,t,r,!0);return{query:"query mutationsQuery( $size: Int $offset: Int $filters: FiltersArgument $filtersWithoutLocation: FiltersArgument $score: String $sort: [Sort] ) { viewer { explore { filteredCases: cases { hits(first: 0, filters: $filtersWithoutLocation) { total } } features: ssms { hits(first: $size, offset: $offset, filters: $filters, score: $score, sort: $sort) { total edges { node { score startPosition: start_position endPosition: end_position mutationType: mutation_type cosmicId: cosmic_id referenceAllele: reference_allele ncbiBuild: ncbi_build genomicDnaChange: genomic_dna_change mutationSubtype: mutation_subtype ssmId: ssm_id chromosome consequence { hits { edges { node { transcript { is_canonical annotation { vep_impact polyphen_impact polyphen_score sift_score sift_impact hgvsc } consequence_type gene { gene_id symbol gene_strand } aa_change transcript_id } id } } } } } } } } } } }",variables:{size:this.size?this.size:5e3,offset:0,filters:n,filtersWithoutLocation:a,score:"occurrence.case.project.project_id",sort:[{field:"_score",order:"desc"},{field:"_uid",order:"asc"}]}}}},{key:"createGeneQuery",value:function(e,t,r){return{query:"query genesQuery( $filters: FiltersArgument $size: Int $offset: Int $score: String ) { viewer { explore { features: genes { hits(first: $size, offset: $offset, filters: $filters, score: $score) { total edges { node { geneId: gene_id id geneStrand: gene_strand synonyms symbol name geneStart: gene_start geneEnd: gene_end geneChromosome: gene_chromosome description canonicalTranscriptId: canonical_transcript_id externalDbIds: external_db_ids { hgnc omimGene: omim_gene uniprotkbSwissprot: uniprotkb_swissprot entrezGene: entrez_gene } biotype isCancerGeneCensus: is_cancer_gene_census } } } } } } }",variables:{filters:this.getFilterQuery(e,t,r,!1),size:this.size?this.size:5e3,offset:0,score:"case.project.project_id"}}}},{key:"getFilterQuery",value:function(e,t,r,n){var a={op:"and",content:[this.addLocationAndCasesToFilter(e,t,r,n)]},o=JSON.parse(this.filters);return o&&Object.keys(o).length>0&&a.content.push(o),a}},{key:"addLocationAndCasesToFilter",value:function(e,t,r,n){var a;if(n)a={op:"and",content:[{op:"in",content:{field:"available_variation_data",value:["ssm"]}}]};else switch(this.featureType){case"mutation":a={op:"and",content:[{op:">=",content:{field:"ssms.start_position",value:t}},{op:"<=",content:{field:"ssms.end_position",value:r}},{op:"=",content:{field:"ssms.chromosome",value:["chr".concat(e)]}}]};break;case"gene":a={op:"and",content:[{op:">=",content:{field:"genes.gene_start",value:t}},{op:"<=",content:{field:"genes.gene_end",value:r}},{op:"=",content:{field:"genes.gene_chromosome",value:[e]}}]};break;default:throw new Error("invalid featureType ".concat(this.featureType))}return this.cases&&this.cases.length>0&&a.content.push({op:"in",content:{field:"cases.case_id",value:this.cases}}),a}}]),a}(p.BaseFeatureDataAdapter);fe.capabilities=["getFeatures","getRefNames"],e.default=function(e){C(o,e);var r=T(o);function o(){var e;return g(this,o),(e=r.apply(this,arguments)).name="GDCPlugin",e}return h(o,[{key:"install",value:function(e){var r=e.lib["@jbrowse/core/pluggableElementTypes/AdapterType"],o=e.lib["@jbrowse/core/pluggableElementTypes/TrackType"],i=e.lib["@jbrowse/core/pluggableElementTypes/WidgetType"],l=e.getPlugin("LinearGenomeViewPlugin").exports.BaseLinearDisplayComponent;e.addAdapterType((function(){return new r({name:"GDCAdapter",configSchema:de,AdapterClass:fe})})),e.addTrackType((function(){var r=t.ConfigurationSchema("GDCTrack",{},{baseConfiguration:a.createBaseTrackConfig(e),explicitIdentifier:"trackId"});return new o({name:"GDCTrack",configSchema:r,stateModel:a.createBaseTrackModel(e,"GDCTrack",r)})})),e.addDisplayType((function(){var t=e.load(pe);return new n({name:"LinearGDCDisplay",configSchema:t.configSchema,stateModel:t.stateModel,trackType:"GDCTrack",viewType:"LinearGenomeView",ReactComponent:l})})),e.addWidgetType((function(){var t=e.load(te);return new i({name:"GDCFilterWidget",HeadingComponent:t.HeadingComponent,configSchema:t.configSchema,stateModel:t.stateModel,ReactComponent:t.ReactComponent})})),e.addWidgetType((function(){var t=e.load(le);return new i({name:"GDCFeatureWidget",heading:"Feature Details",configSchema:t.configSchema,stateModel:t.stateModel,ReactComponent:t.ReactComponent})}))}}]),o}(r),Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=jbrowse-plugin-gdc.umd.production.min.js.map
